(()=>{"use strict";var t={76:function(t,e,i){var s=i(893),r=i(745),h=i(294);function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let n=new Uint8Array([240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128]),a=1/60*1e3;class c{start(){this.running||(this.lastDelayTimeStep=Date.now(),this.running=!0,this.update())}stop(){clearTimeout(this.updateTimeout),this.clearGraphics(),this.clearMemory(),this.clearStack(),this.clearVRegisters(),this.currentOpcode=0,this.delayTimer=0,this.drawFlag=!1,this.indexRegister=0,this.programCounter=0,this.running=!1,this.soundTimer=0,this.stackPointer=0}update(){if(this.running){let t=Date.now();t-this.lastDelayTimeStep>a&&(this.lastDelayTimeStep=t,this.delayTimer=Math.max(0,this.delayTimer-1),this.soundTimer=Math.max(0,this.soundTimer-1)),this.fetchNextOpcode(),this.runCurrentOpcode(),this.updateTimeout=setTimeout(this.update.bind(this),1)}}fetchNextOpcode(){this.currentOpcode=this.memory[this.programCounter]<<8|this.memory[this.programCounter+1]}runCurrentOpcode(){this.jumpTable[(61440&this.currentOpcode)>>12]()}clearGraphics(){this.graphics.fill(0)}clearMemory(){this.memory.fill(0)}clearVRegisters(){this.vRegisters.fill(0)}clearStack(){this.stack.fill(0)}loadRom(t){this.memory.set(t,512)}getOpcodeX(){return(3840&this.currentOpcode)>>8}getOpcodeY(){return(240&this.currentOpcode)>>4}getOpcodeNN(){return 255&this.currentOpcode}op0NNN(){(15&this.currentOpcode)==0?(this.clearGraphics(),this.drawFlag=!0):(15&this.currentOpcode)==14&&(this.stackPointer-=1,this.programCounter=this.stack[this.stackPointer]),this.programCounter+=2}op1NNN(){this.programCounter=4095&this.currentOpcode}op2NNN(){this.stack[this.stackPointer]=this.programCounter,this.stackPointer+=1,this.programCounter=4095&this.currentOpcode}op3XNN(){let t=this.getOpcodeX(),e=this.getOpcodeNN();this.vRegisters[t]===e?this.programCounter+=4:this.programCounter+=2}op4XNN(){let t=this.getOpcodeX(),e=this.getOpcodeNN();this.vRegisters[t]!==e?this.programCounter+=4:this.programCounter+=2}op5XY0(){let t=this.getOpcodeX(),e=this.getOpcodeY();this.vRegisters[t]===this.vRegisters[e]?this.programCounter+=4:this.programCounter+=2}op6XNN(){let t=this.getOpcodeX(),e=this.getOpcodeNN();this.vRegisters[t]=e,this.programCounter+=2}op7XNN(){let t=this.getOpcodeX(),e=this.getOpcodeNN();this.vRegisters[t]+=e,this.programCounter+=2}op8XYN(){this.jumpTable8XYN[15&this.currentOpcode]()}op8XY0(){let t=this.getOpcodeX(),e=this.getOpcodeY();this.vRegisters[t]=this.vRegisters[e],this.programCounter+=2}op8XY1(){let t=this.getOpcodeX(),e=this.getOpcodeY();this.vRegisters[t]|=this.vRegisters[e],this.programCounter+=2}op8XY2(){let t=this.getOpcodeX(),e=this.getOpcodeY();this.vRegisters[t]&=this.vRegisters[e],this.programCounter+=2}op8XY3(){let t=this.getOpcodeX(),e=this.getOpcodeY();this.vRegisters[t]^=this.vRegisters[e],this.programCounter+=2}op8XY4(){let t=this.getOpcodeX(),e=this.getOpcodeY(),i=this.vRegisters[t],s=this.vRegisters[e];i>255-s?this.vRegisters[15]=1:this.vRegisters[15]=0,15!==t&&(this.vRegisters[t]=i+s),this.programCounter+=2}op8XY5(){let t=this.getOpcodeX(),e=this.getOpcodeY(),i=this.vRegisters[t],s=this.vRegisters[e];s>i?this.vRegisters[15]=0:this.vRegisters[15]=1,15!==t&&(this.vRegisters[t]=i-s),this.programCounter+=2}op8XY6(){let t=this.getOpcodeX();this.vRegisters[15]=1&this.vRegisters[t],15!==t&&(this.vRegisters[t]>>=1),this.programCounter+=2}op8XY7(){let t=this.getOpcodeX(),e=this.getOpcodeY(),i=this.vRegisters[t],s=this.vRegisters[e];i>s?this.vRegisters[15]=0:this.vRegisters[15]=1,15!==t&&(this.vRegisters[t]=s-i),this.programCounter+=2}op8XYE(){let t=this.getOpcodeX();this.vRegisters[15]=this.vRegisters[t]>>7,15!==t&&(this.vRegisters[t]<<=1),this.programCounter+=2}op9XY0(){let t=this.getOpcodeX(),e=this.getOpcodeY();this.vRegisters[t]!==this.vRegisters[e]?this.programCounter+=4:this.programCounter+=2}opANNN(){this.indexRegister=4095&this.currentOpcode,this.programCounter+=2}opBNNN(){this.programCounter=(4095&this.currentOpcode)+this.vRegisters[0]}opCXNN(){let t=this.getOpcodeX(),e=this.getOpcodeNN(),i=Math.floor(256*Math.random());this.vRegisters[t]=i&e,this.programCounter+=2}opDXYN(){let t=this.vRegisters[this.getOpcodeX()],e=this.vRegisters[this.getOpcodeY()],i=15&this.currentOpcode,s=0;this.vRegisters[15]=0;for(let r=0;r<i;r++){s=this.memory[this.indexRegister+r];for(let i=0;i<8;i++)if(0!=(s&128>>i)){let s=t+i+(e+r)*64;1===this.graphics[s]&&(this.vRegisters[15]=1),this.graphics[s]^=1}}this.drawFlag=!0,this.programCounter+=2}opE000(){let t=this.vRegisters[this.getOpcodeX()],e=this.getOpcodeNN();158===e?this.programCounter+=this.keypad[t]?4:2:161===e&&(this.programCounter+=this.keypad[t]?2:4)}opF000(){let t=this.getOpcodeX();switch(this.getOpcodeNN()){case 7:this.vRegisters[t]=this.delayTimer;break;case 10:let e=!1;for(let i=0;i<16;i++)this.keypad[i]&&(e=!0,this.vRegisters[t]=i);if(!e)return;break;case 21:this.delayTimer=this.vRegisters[t];break;case 24:this.soundTimer=this.vRegisters[t];break;case 30:let i=this.vRegisters[t];this.indexRegister+i>4095?this.vRegisters[15]=1:this.vRegisters[15]=0,this.indexRegister+=i;break;case 41:this.indexRegister=5*this.vRegisters[t];break;case 51:this.memory[this.indexRegister]=this.vRegisters[t]/100,this.memory[this.indexRegister+1]=this.vRegisters[t]/10%10,this.memory[this.indexRegister+2]=this.vRegisters[t]%100%10;break;case 85:for(let e=0;e<=t;e++)this.memory[this.indexRegister+e]=this.vRegisters[e];break;case 101:for(let e=0;e<=t;e++)this.vRegisters[e]=this.memory[this.indexRegister+e]}this.programCounter+=2}constructor(){o(this,"currentOpcode",void 0),o(this,"delayTimer",void 0),o(this,"drawFlag",void 0),o(this,"graphics",void 0),o(this,"indexRegister",void 0),o(this,"jumpTable8XYN",void 0),o(this,"jumpTable",void 0),o(this,"keypad",void 0),o(this,"lastDelayTimeStep",void 0),o(this,"memory",void 0),o(this,"programCounter",void 0),o(this,"running",void 0),o(this,"soundTimer",void 0),o(this,"stack",void 0),o(this,"stackPointer",void 0),o(this,"vRegisters",void 0),o(this,"updateTimeout",void 0),this.currentOpcode=0,this.delayTimer=0,this.drawFlag=!1,this.graphics=new Uint8Array(2048),this.indexRegister=0,this.keypad=Array(16).fill(!1),this.lastDelayTimeStep=0,this.memory=new Uint8Array(4096),this.programCounter=0,this.running=!1,this.soundTimer=0,this.stack=new Uint16Array(16),this.stackPointer=0,this.vRegisters=new Uint8Array(16),this.memory.set(n,0),this.jumpTable=[this.op0NNN.bind(this),this.op1NNN.bind(this),this.op2NNN.bind(this),this.op3XNN.bind(this),this.op4XNN.bind(this),this.op5XY0.bind(this),this.op6XNN.bind(this),this.op7XNN.bind(this),this.op8XYN.bind(this),this.op9XY0.bind(this),this.opANNN.bind(this),this.opBNNN.bind(this),this.opCXNN.bind(this),this.opDXYN.bind(this),this.opE000.bind(this),this.opF000.bind(this)],this.jumpTable8XYN=[this.op8XY0.bind(this),this.op8XY1.bind(this),this.op8XY2.bind(this),this.op8XY3.bind(this),this.op8XY4.bind(this),this.op8XY5.bind(this),this.op8XY6.bind(this),this.op8XY7.bind(this),()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},this.op8XYE.bind(this)]}}class d{start(){this.running||(this.canvas.className="canvas-started",this.running=!0,this.update())}stop(){this.running=!1}destroy(){this.stop(),this.canvas.remove()}update(){if(this.running){if(this.chip8.drawFlag){this.context.fillStyle="#22232a",this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle="#758cd1";for(let t=0;t<32;t++)for(let e=0;e<64;e++){let i=e+64*t;this.chip8.graphics[i]&&this.context.fillRect(e*this.pixelSize,t*this.pixelSize,this.pixelSize,this.pixelSize)}}window.requestAnimationFrame(this.update.bind(this))}}constructor(t,e,i){o(this,"animationFrame",void 0),o(this,"canvas",void 0),o(this,"chip8",void 0),o(this,"context",void 0),o(this,"pixelSize",void 0),o(this,"running",void 0),this.chip8=i,this.pixelSize=e,this.running=!1,this.canvas=document.createElement("canvas"),this.canvas.width=64*e,this.canvas.height=32*e,this.canvas.className="canvas-stopped",this.canvas.tabIndex=-1;let s=this.canvas.getContext("2d");if(!s)throw Error("Missing canvas context");this.context=s;let r=document.getElementById(t);if(!r)throw Error(`Missing canvas container ${t}`);r.prepend(this.canvas)}}let p={1:1,2:2,3:3,4:12,q:4,w:5,e:6,r:13,a:7,s:8,d:9,f:14,z:10,x:0,c:11,v:15};class u{start(){document.addEventListener("keydown",this.handleKey),document.addEventListener("keyup",this.handleKey)}stop(){document.removeEventListener("keydown",this.handleKey),document.removeEventListener("keyup",this.handleKey)}constructor(t){o(this,"chip8",void 0),o(this,"keydownListener",void 0),o(this,"keyupListener",void 0),o(this,"handleKey",t=>{this.chip8.running&&void 0!==p[t.key]&&(this.chip8.keypad[p[t.key]]="keydown"===t.type)}),this.chip8=t}}let g=i.p+"static/media/beep.8f00bf35.mp3";class l{start(){this.running||(this.running=!0,this.update())}stop(){this.running=!1}update(){this.running&&(this.chip8.soundTimer>0&&this.audio.play(),window.requestAnimationFrame(this.update.bind(this)))}constructor(t,e){if(o(this,"audio",void 0),o(this,"chip8",void 0),o(this,"running",void 0),this.chip8=e,this.running=!1,!document.getElementById(t))throw Error(`Missing audio container ${t}`);this.audio=document.createElement("audio"),this.audio.preload="auto",this.audio.src=g}}let v={Brix:new Uint8Array([110,5,101,0,107,6,106,0,163,12,218,177,122,4,58,64,18,8,123,2,59,18,18,6,108,32,109,31,163,16,220,209,34,246,96,0,97,0,163,18,208,17,112,8,163,14,208,17,96,64,240,21,240,7,48,0,18,52,198,15,103,30,104,1,105,255,163,14,214,113,163,16,220,209,96,4,224,161,124,254,96,6,224,161,124,2,96,63,140,2,220,209,163,14,214,113,134,132,135,148,96,63,134,2,97,31,135,18,71,31,18,172,70,0,104,1,70,63,104,255,71,0,105,1,214,113,63,1,18,170,71,31,18,170,96,5,128,117,63,0,18,170,96,1,240,24,128,96,97,252,128,18,163,12,208,113,96,254,137,3,34,246,117,1,34,246,69,96,18,222,18,70,105,255,128,96,128,197,63,1,18,202,97,2,128,21,63,1,18,224,128,21,63,1,18,238,128,21,63,1,18,232,96,32,240,24,163,14,126,255,128,224,128,4,97,0,208,17,62,0,18,48,18,222,120,255,72,254,104,255,18,238,120,1,72,2,104,1,96,4,240,24,105,255,18,112,163,20,245,51,242,101,241,41,99,55,100,0,211,69,115,5,242,41,211,69,0,238,224,0,128,0,252,0,170,0,0,0,0,0]),Tetris:new Uint8Array([162,180,35,230,34,182,112,1,208,17,48,37,18,6,113,255,208,17,96,26,208,17,96,37,49,0,18,14,196,112,68,112,18,28,195,3,96,30,97,3,34,92,245,21,208,20,63,1,18,60,208,20,113,255,208,20,35,64,18,28,231,161,34,114,232,161,34,132,233,161,34,150,226,158,18,80,102,0,246,21,246,7,54,0,18,60,208,20,113,1,18,42,162,196,244,30,102,0,67,1,102,4,67,2,102,8,67,3,102,12,246,30,0,238,208,20,112,255,35,52,63,1,0,238,208,20,112,1,35,52,0,238,208,20,112,1,35,52,63,1,0,238,208,20,112,255,35,52,0,238,208,20,115,1,67,4,99,0,34,92,35,52,63,1,0,238,208,20,115,255,67,255,99,3,34,92,35,52,0,238,128,0,103,5,104,6,105,4,97,31,101,16,98,7,0,238,64,224,0,0,64,192,64,0,0,224,64,0,64,96,64,0,64,64,96,0,32,224,0,0,192,64,64,0,0,224,128,0,64,64,192,0,0,224,32,0,96,64,64,0,128,224,0,0,64,192,128,0,192,96,0,0,64,192,128,0,192,96,0,0,128,192,64,0,0,96,192,0,128,192,64,0,0,96,192,0,192,192,0,0,192,192,0,0,192,192,0,0,192,192,0,0,64,64,64,64,0,240,0,0,64,64,64,64,0,240,0,0,208,20,102,53,118,255,54,0,19,56,0,238,162,180,140,16,60,30,124,1,60,30,124,1,60,30,124,1,35,94,75,10,35,114,145,192,0,238,113,1,19,80,96,27,107,0,208,17,63,0,123,1,208,17,112,1,48,37,19,98,0,238,96,27,208,17,112,1,48,37,19,116,142,16,141,224,126,255,96,27,107,0,208,225,63,0,19,144,208,225,19,148,208,209,123,1,112,1,48,37,19,134,75,0,19,166,125,255,126,255,61,1,19,130,35,192,63,1,35,192,122,1,35,192,128,160,109,7,128,210,64,4,117,254,69,2,101,4,0,238,167,0,242,85,168,4,250,51,242,101,240,41,109,50,110,0,221,229,125,5,241,41,221,229,125,5,242,41,221,229,167,0,242,101,162,180,0,238,106,0,96,25,0,238,55,35]),UFO:new Uint8Array([162,205,105,56,106,8,217,163,162,208,107,0,108,3,219,195,162,214,100,29,101,31,212,81,103,0,104,15,34,162,34,172,72,0,18,34,100,30,101,28,162,211,212,83,110,0,102,128,109,4,237,161,102,255,109,5,237,161,102,0,109,6,237,161,102,1,54,128,34,216,162,208,219,195,205,1,139,212,219,195,63,0,18,146,162,205,217,163,205,1,61,0,109,255,121,254,217,163,63,0,18,140,78,0,18,46,162,211,212,83,69,0,18,134,117,255,132,100,212,83,63,1,18,70,109,8,141,82,77,8,18,140,18,146,34,172,120,255,18,30,34,162,119,5,18,150,34,162,119,15,34,162,109,3,253,24,162,211,212,83,18,134,162,248,247,51,99,0,34,182,0,238,162,248,248,51,99,50,34,182,0,238,109,27,242,101,240,41,211,213,115,5,241,41,211,213,115,5,242,41,211,213,0,238,1,124,254,124,96,240,96,64,224,160,248,212,110,1,109,16,253,24,0,238])},m={Brix:{q:"move left",e:"move right"},Tetris:{q:"rotate piece",w:"move left",e:"move right",a:"soft drop"},UFO:{q:"shoot northwest",w:"shoot north",e:"shoot northeast"}},R=t=>{let{currentRom:e}=t;return(0,s.jsx)("div",{id:"keyboard-inputs",children:e&&Object.entries(m[e]).map(t=>{let[e,i]=t;return(0,s.jsxs)("span",{children:[(0,s.jsx)("b",{children:e})," ",i]})})})},N=t=>{let{currentRom:e,setRom:i}=t;return(0,s.jsxs)("select",{id:"rom-selector",name:"roms",value:e,onChange:t=>i(t.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select Rom"}),Object.keys(v).map(t=>(0,s.jsx)("option",{value:t,children:t},t))]})},y=()=>(0,s.jsxs)("a",{id:"view-github-link",href:"https://github.com/zcr1/chip8",target:"_blank",children:["View on GitHub",(0,s.jsx)("svg",{viewBox:"0 0 16 16",width:"16",height:"16","aria-hidden":"true",children:(0,s.jsx)("path",{d:"M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"})})]}),O=document.getElementById("root");O&&r.createRoot(O).render((0,s.jsx)(()=>{(0,h.useEffect)(()=>{function t(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","G-ZT5KEBKGMT")},[]);let t=(0,h.useRef)(null),e=(0,h.useRef)(null),i=(0,h.useRef)(null),r=(0,h.useRef)(null),[o,n]=(0,h.useState)(),[a,p]=(0,h.useState)();return(0,h.useEffect)(()=>(t.current=new c,e.current=new d("root",12,t.current),i.current=new u(t.current),r.current=new l("root",t.current),()=>{var s,h,o,n;null==(s=e.current)||s.destroy(),null==(h=t.current)||h.stop(),null==(o=i.current)||o.stop(),null==(n=r.current)||n.stop()}),[]),(0,s.jsxs)("div",{className:"content",children:[(0,s.jsx)(y,{}),(0,s.jsx)(R,{currentRom:a}),(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{id:"start-button",onClick:function(){var s,h,n,a,c,d,u;o&&(p(o),null==(s=document.getElementsByTagName("canvas")[0])||s.focus(),null==(h=t.current)||h.stop(),null==(n=t.current)||n.loadRom(v[o]),null==(a=e.current)||a.start(),null==(c=t.current)||c.start(),null==(d=i.current)||d.start(),null==(u=r.current)||u.start())},children:"Start"}),(0,s.jsx)(N,{currentRom:o,setRom:n})]})]})},{}))}},e={};function i(s){var r=e[s];if(void 0!==r)return r.exports;var h=e[s]={exports:{}};return t[s](h,h.exports,i),h.exports}i.m=t,i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=[];i.O=(e,s,r,h)=>{if(s){h=h||0;for(var o=t.length;o>0&&t[o-1][2]>h;o--)t[o]=t[o-1];t[o]=[s,r,h];return}for(var n=1/0,o=0;o<t.length;o++){for(var[s,r,h]=t[o],a=!0,c=0;c<s.length;c++)(!1&h||n>=h)&&Object.keys(i.O).every(t=>i.O[t](s[c]))?s.splice(c--,1):(a=!1,h<n&&(n=h));if(a){t.splice(o--,1);var d=r();void 0!==d&&(e=d)}}return e}})(),i.p="/",(()=>{var t={980:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var r,h,[o,n,a]=s,c=0;if(o.some(e=>0!==t[e])){for(r in n)i.o(n,r)&&(i.m[r]=n[r]);if(a)var d=a(i)}for(e&&e(s);c<o.length;c++)h=o[c],i.o(t,h)&&t[h]&&t[h][0](),t[h]=0;return i.O(d)},s=self.webpackChunkchip8=self.webpackChunkchip8||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var s=i.O(void 0,["361"],function(){return i(76)});s=i.O(s)})();